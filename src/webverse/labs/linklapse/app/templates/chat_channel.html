{% extends "_base.html" %}
{% block title %}LinkLapse · Chat{% endblock %}

{% block content %}
<div class="row g-4">
  <div class="col-lg-3">
    <div class="cardx p-3">
      <div class="fw-semibold mb-2">Channels</div>
      <div class="list-group list-group-flush">
        {% for c in channels %}
          <a class="list-group-item list-group-item-action bg-transparent text-light border-secondary-subtle {% if c==channel %}active{% endif %}"
             href="http://chat.{{domain}}/channel/{{c}}">
            #{{c}}
          </a>
        {% endfor %}
      </div>
    </div>

    <div class="cardx p-3 mt-3">
      <div class="fw-semibold mb-1">Surface</div>
      <div class="text-muted small mono">chat.{{domain}}</div>
      <hr class="hr-soft my-3"/>
      <a class="btn btn-sm btn-outline-light w-100" href="http://chat.{{domain}}/leave?next=http://chat.{{domain}}/channel/{{channel}}">
        Leave
      </a>
    </div>
  </div>

  <div class="col-lg-9">
    <div class="cardx p-4">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h4 class="mb-0">#{{ channel }}</h4>
          <div class="text-muted small">Internal triage and support chatter.</div>
        </div>
        <span class="chip mono">chat/send</span>
      </div>

      <hr class="hr-soft my-3"/>

      <div class="d-grid gap-2" style="max-height: 56vh; overflow:auto;">
        {% for m in messages %}
          <div class="msg">
            <div class="meta mono">{{ m["created_at"] }} · {{ m["author"] }}</div>
            <div class="body">{{ m["body"] }}</div>
          </div>
        {% endfor %}
      </div>

      <hr class="hr-soft my-3"/>

      <form method="POST" action="http://chat.{{domain}}/chat/send" class="d-flex gap-2">
        <input type="hidden" name="channel" value="{{channel}}" />
        <input class="form-control" name="body" placeholder="message…" autocomplete="off" />
        <button class="btn btn-primary">Send</button>
      </form>

      <div class="text-muted small mt-2">
        Ops triage sometimes includes links to “leave” pages or redirects. Don’t click things you don’t trust.
      </div>
    </div>
  </div>
</div>
{% endblock %}
